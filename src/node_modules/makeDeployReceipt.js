const bel = require("bel")
const csjs = require('csjs-inject')
const theme = require('theme')
var colors = setTheme('darkTheme')
const date = require('getDate')
const copy = require('copy-text-to-clipboard')
const moreInfo = require('moreInfo')

module.exports = makeDeployReceipt

function setTheme(name) {
  let colors = Object.assign({}, theme(name))
  return colors
}

var css = csjs`
.txReceipt {
  display:flex;
  justify-content: flex-start;
  flex-direction: column;
  margin-left: 1em;
  position: relative;
  z-index: 99;
}
.txReturnField {
  display:flex;
  justify-content: flex-start;
  flex-direction: column;
  margin-bottom: 2%;
}
.txReturnTitle {
  color: ${colors.txReturnTitleColor};
  font-size: ${colors.txReturnTitleFontSize};
}
.txReturnValue {
  color: ${colors.txReturnValueColor};
  font-size: ${colors.txReturnValueFontSize};
  word-break: break-all;
  white-spacing: pre-wrap;
}
.txReturnValue:hover {
  opacity: 0.6;
}
.date {}
`

function makeDeployReceipt (provider, contract) {
  var el = bel`
    <div class=${css.txReceipt}>
      <div class=${css.txReturnField}>
        <div class=${css.txReturnTitle}>published</div>
        <div class=${css.txReturnValue}>${date()}</div>
      </div>
      <div class=${css.txReturnField} title="${contract.deployTransaction.creates}" onclick=${()=>copy(contract.deployTransaction.creates)}>
        <div class=${css.txReturnTitle}>contract address (${provider._network.name}):</div>
        <div class=${css.txReturnValue}>${contract.deployTransaction.creates}</div>
      </div>
      <div class=${css.txReturnField} title="${contract.deployTransaction.from}" onclick=${()=>copy(contract.deployTransaction.from)}>
        <div class=${css.txReturnTitle}>published by</div>
        <div class=${css.txReturnValue}>${contract.deployTransaction.from}</div>
      </div>
    </div>
  `
  el.appendChild(moreInfo(provider._network.name, contract.deployTransaction.hash))
  return el
}
